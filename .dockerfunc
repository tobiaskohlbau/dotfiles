function del_stopped() {
	local name=$1
	local state=$(docker inspect --format "{{.State.Running}}" $name 2>/dev/null)

	if [[ "$state" == "false" ]]; then
		docker rm $name
	fi
}

function chrome() {
	del_stopped chrome

	docker run -it \
		--memory 3gb \
		--net host \
        --cap-add SYS_ADMIN \
		-v /etc/localtime:/etc/localtime:ro \
		-v /tmp/.X11-unix:/tmp/.X11-unix \
		-e DISPLAY=unix$DISPLAY \
		-v $HOME/Downloads:/root/Downloads \
		-v $HOME/.chrome:/data \
		-v /dev/shm:/dev/shm \
		-v /etc/hosts:/etc/hosts \
		--device /dev/snd \
		--device /dev/dri \
		--group-add audio \
		--group-add video \
		--name chrome \
		jess/chrome --user-data-dir=/data "$@"
}

function firefox() {
	del_stopped firefox

	docker run -it \
		--memory 2gb \
		--net host \
		--cpuset-cpus 0 \
		-v /etc/localtime:/etc/localtime:ro \
		-v /tmp/.X11-unix:/tmp/.X11-unix \
		-v $HOME/.firefox/cache:/root/.cache/mozilla \
		-v $HOME/.firefox/mozilla:/root/.mozilla \
		-v $HOME/Downloads:/root/Downloads \
		-v $HOME/Pictures:/root/Pictures \
		-v $HOME/Torrents:/root/Torrents \
        -v $HOME/.config/pulse/cookie:/run/pulse/cookie \
        -v /usr/share/sounds:/usr/share/sounds \
        -e PULSE_SERVER=tcp:$(hostname -i | gawk -F ' ' '{print $1}'):4713 \
        -e PULSE_COOKIE_DATA=$(pax11publish -d | grep --color=never -Po '(?<=^Cookie: ).*') \
		-e DISPLAY=unix$DISPLAY \
		-e GDK_SCALE \
		-e GDK_DPI_SCALE \
		--device /dev/snd \
		--device /dev/dri \
		--name firefox \
		koht/firefox "$@"
}

function spotify() {
	del_stopped spotify

	docker run -d \
		--net host \
		-v /etc/localtime:/etc/localtime:ro \
		-v /tmp/.X11-unix:/tmp/.X11-unix \
        -v $HOME/.config/pulse/cookie:/run/pulse/cookie \
        -e PULSE_SERVER=tcp:$(hostname -i | gawk -F ' ' '{print $1}'):4713 \
        -e PULSE_COOKIE_DATA=$(pax11publish -d | grep --color=never -Po '(?<=^Cookie: ).*') \
		-e DISPLAY=unix$DISPLAY \
		-e QT_DEVICE_PIXEL_RATIO \
		--device /dev/snd \
        --group-add audio \
        --group-add video \
		--name spotify \
		jess/spotify
}
